{% extends 'base.html' %}

{% block content %}
<div class="container py-5">
  <h2 class="mb-3">Subscription Plans</h2>
  <p>Choose a plan to enjoy premium content.</p>
  <div class="row">
    {% for plan in plans %}
    <div class="col-md-4">
      <div class="card mb-3">
        <div class="card-body">
          <h5 class="card-title">{{ plan.name }}</h5>
          <p class="card-text">Price: <strong>${{ '%.2f'|format(plan.price) }}</strong></p>
          <p class="card-text">Duration: {{ plan.duration_days }} days</p>
          {% if active and active.plan_id == plan.id %}
            <span class="badge bg-success">Active until {{ active.end_date.strftime('%Y-%m-%d') }}</span>
            <form method="POST" action="{{ url_for('cancel_subscription') }}" style="display:inline">
              <button class="btn btn-sm btn-outline-warning ms-2">Cancel</button>
            </form>
          {% elif plan.price == 0.0 %}
            <span class="badge bg-secondary">Free</span>
            <a class="btn btn-outline-primary btn-sm float-end" href="{{ url_for('subscribe', plan_id=plan.id) }}">Select</a>
          {% else %}
            <a class="btn btn-primary float-end" href="{{ url_for('subscribe', plan_id=plan.id) }}">Subscribe</a>
          {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
